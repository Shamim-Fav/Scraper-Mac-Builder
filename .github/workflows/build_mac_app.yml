name: Mac App Builder (PyInstaller)

on:
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build-mac:
    runs-on: macos-latest  # Use the macOS virtual environment

    steps:
    - name: 1. Checkout Code
      uses: actions/checkout@v4

    - name: 2. Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: 3. Install Dependencies
      run: |
        python -m pip install --upgrade pip
        # These are the libraries needed for your script
        pip install pyinstaller undetected-chromedriver selenium pandas

    - name: 4. Run PyInstaller Build
      run: |
        # --onefile: Packages everything into a single folder/file structure
        # --windowed: Suppresses the black console window on Mac
        # --name: Sets the output file name
        pyinstaller --onefile --windowed --name "WSP Scraper" scraper_gui.py
      
    - name: 5. Prepare and Archive (Zip) the Application
      run: |
        # Navigate to the output directory
        cd dist
        # Zip the .app file structure so it can be downloaded easily
        zip -r "WSP_Scraper_Mac.zip" "WSP Scraper.app"
        
    - name: 6. Upload the Zipped Application (Artifact)
      uses: actions/upload-artifact@v4
      with:
        name: macos-scraper-app
        path: dist/WSP_Scraper_Mac.zip
        retention-days: 7
